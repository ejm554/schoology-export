<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schoology URL Opener</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin: 10px 0;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px 10px 10px 0;
            cursor: pointer;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            min-height: 20px;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        h2 {
            margin-top: 0;
        }
        .instructions {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Schoology URL Opener</h1>
    
    <div class="instructions">
        <strong>Instructions:</strong>
        <ol>
            <li>Open your <code>_MANIFEST.csv</code> file in Excel or Google Sheets</li>
            <li>Filter by Type column for items you want to open</li>
            <li>Copy the URLs from the URL column</li>
            <li>Paste into the appropriate textarea below</li>
            <li>Click "Start" to open URLs one at a time (2 second delay)</li>
            <li>Clear console (Cmd+K) before each run for clean logs</li>
        </ol>
    </div>

    <div class="section">
        <h2>Assignment & Discussion URLs</h2>
        <p>Paste URLs for ASSIGNMENT and OTHER types (one per line):</p>
        <textarea id="assignmentUrls" placeholder="https://schoology.isd623.org/assignment/...
https://schoology.isd623.org/assignment/..."></textarea>
        <button onclick="openAssignmentUrls()">Start Opening Assignments</button>
        <div class="status" id="assignmentStatus"></div>
    </div>

    <div class="section">
        <h2>Link & Embedded Page URLs</h2>
        <p>Paste URLs for LINK and EMBEDDED_PAGE types (one per line):</p>
        <textarea id="linkUrls" placeholder="https://example.com/resource
https://docs.google.com/..."></textarea>
        <button onclick="openLinkUrls()">Start Opening Links</button>
        <div class="status" id="linkStatus"></div>
    </div>

    <script>
        let assignmentIndex = 0;
        let assignmentUrlArray = [];
        let assignmentStartTime = null;
        
        let linkIndex = 0;
        let linkUrlArray = [];
        let linkStartTime = null;

        function openAssignmentUrls() {
            const textarea = document.getElementById('assignmentUrls');
            assignmentUrlArray = textarea.value
                .split('\n')
                .map(url => url.trim())
                .filter(url => url.length > 0);
            
            if (assignmentUrlArray.length === 0) {
                document.getElementById('assignmentStatus').textContent = 'No URLs found. Please paste URLs into the textarea.';
                return;
            }
            
            assignmentIndex = 0;
            assignmentStartTime = Date.now();
            console.log(`[${new Date().toISOString()}] Starting batch of ${assignmentUrlArray.length} assignment URLs`);
            openNextAssignment();
        }

        function openNextAssignment() {
            const now = new Date().toISOString();
            const elapsed = assignmentStartTime ? ((Date.now() - assignmentStartTime) / 1000).toFixed(1) : 0;
            
            console.log(`[${now}] [${elapsed}s] DEBUG: assignmentIndex=${assignmentIndex}, total=${assignmentUrlArray.length}`);
            
            if (assignmentIndex < assignmentUrlArray.length) {
                const url = assignmentUrlArray[assignmentIndex];
                console.log(`[${now}] [${elapsed}s] DEBUG: About to open URL: ${url}`);
                
                document.getElementById('assignmentStatus').textContent = 
                    `Opening ${assignmentIndex + 1} of ${assignmentUrlArray.length}: ${url} (${elapsed}s elapsed)`;
                
                window.open(url, '_blank');
                console.log(`[${now}] [${elapsed}s] DEBUG: window.open() called, setting timeout...`);
                
                assignmentIndex++;
                setTimeout(openNextAssignment, 5000);
            } else {
                console.log(`[${now}] [${elapsed}s] DEBUG: All done! Total time: ${elapsed}s`);
                document.getElementById('assignmentStatus').textContent = 
                    `✓ Done! Opened ${assignmentUrlArray.length} assignment URLs in ${elapsed} seconds.`;
            }
        }

        function openLinkUrls() {
            const textarea = document.getElementById('linkUrls');
            linkUrlArray = textarea.value
                .split('\n')
                .map(url => url.trim())
                .filter(url => url.length > 0);
            
            if (linkUrlArray.length === 0) {
                document.getElementById('linkStatus').textContent = 'No URLs found. Please paste URLs into the textarea.';
                return;
            }
            
            linkIndex = 0;
            linkStartTime = Date.now();
            console.log(`[${new Date().toISOString()}] Starting batch of ${linkUrlArray.length} link URLs`);
            openNextLink();
        }

        function openNextLink() {
            const now = new Date().toISOString();
            const elapsed = linkStartTime ? ((Date.now() - linkStartTime) / 1000).toFixed(1) : 0;
            
            console.log(`[${now}] [${elapsed}s] DEBUG: linkIndex=${linkIndex}, total=${linkUrlArray.length}`);
            
            if (linkIndex < linkUrlArray.length) {
                const url = linkUrlArray[linkIndex];
                console.log(`[${now}] [${elapsed}s] DEBUG: About to open URL: ${url}`);
                
                document.getElementById('linkStatus').textContent = 
                    `Opening ${linkIndex + 1} of ${linkUrlArray.length}: ${url} (${elapsed}s elapsed)`;
                
                window.open(url, '_blank');
                console.log(`[${now}] [${elapsed}s] DEBUG: window.open() called, setting timeout...`);
                
                linkIndex++;
                setTimeout(openNextLink, 5000);
            } else {
                console.log(`[${now}] [${elapsed}s] DEBUG: All done! Total time: ${elapsed}s`);
                document.getElementById('linkStatus').textContent = 
                    `✓ Done! Opened ${linkUrlArray.length} link URLs in ${elapsed} seconds.`;
            }
        }
    </script>
</body>
</html>